<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Train Function Model — func_train • cntk</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">cntk</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/CharacterLM.html">CharacterLM</a>
    </li>
    <li>
      <a href="../articles/cifar10_example.html">CIFAR-10 Image Classification with Convolutional Neural Networks and CNTK</a>
    </li>
    <li>
      <a href="../articles/installation.html">Installing CNTK and the CNTK Package on Your System</a>
    </li>
    <li>
      <a href="../articles/mnist_example.html">Convolutional Neural Netowrks with MNIST</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/Microsoft/CNTK-R">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Train Function Model</h1>
    </div>

    
    <p>Trains a model, given by its criterion function, using the specified
training parameters and configs. Different aspects of training such as data
sources, checkpointing, cross validation, progress printing can be
configured using the corresponding config classes.</p>
    

    <pre class="usage"><span class='fu'>func_train</span>(<span class='no'>func</span>, <span class='no'>minibatch_source</span>, <span class='kw'>minibatch_size</span> <span class='kw'>=</span> <span class='fl'>32</span>, <span class='kw'>streams</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>model_inputs_to_streams</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>parameter_learners</span> <span class='kw'>=</span> <span class='fu'>c</span>(),
  <span class='kw'>callbacks</span> <span class='kw'>=</span> <span class='fu'>c</span>(), <span class='kw'>progress_frequency</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>max_epochs</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>epoch_size</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>max_samples</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>func</th>
      <td><p>- The CNTK `Function` instance on which to apply the operation</p></td>
    </tr>
    <tr>
      <th>minibatch_source</th>
      <td><p>(MinibatchSource or list of matrices) –
data source used for training. For large data, use a MinibatchSource. For
small data, pass a list of matrices. The number of streams/arrays
must match the number of arguments of self.</p></td>
    </tr>
    <tr>
      <th>minibatch_size</th>
      <td><p>(int or minibatch_size_schedule, defaults to 32) –
minibatch size (or schedule) for training</p></td>
    </tr>
    <tr>
      <th>streams</th>
      <td><p>(list) – (only if minibatch_source is a data reader)
the streams of the minibatch_source in argument order. Not to be given if
minibatch_source is specified as numpy/scipy arrays rather than a data
reader.</p></td>
    </tr>
    <tr>
      <th>model_inputs_to_streams</th>
      <td><p>(dict) – alternative to streams, specifying
the mapping as a map from input variables to streams</p></td>
    </tr>
    <tr>
      <th>parameter_learners</th>
      <td><p>(list) – list of learners</p></td>
    </tr>
    <tr>
      <th>callbacks</th>
      <td><p>- list of callback objects, which can be of type
ProgressWriter (for logging), CheckpointConfig (for #' check-pointing),
TestConfig (for automatic final evaluation on a test set), #' and
CrossValidationConfig (for cross-validation based training control).</p></td>
    </tr>
    <tr>
      <th>progress_frequency</th>
      <td><p>(int) – frequency in samples for aggregated
progress printing. Defaults to epoch_size if given, or None otherwise</p></td>
    </tr>
    <tr>
      <th>max_epochs</th>
      <td><p>(int, defaults to 1) – maximum number of samples used for
training; requires epoch_size</p></td>
    </tr>
    <tr>
      <th>epoch_size</th>
      <td><p>(int) – in CNTK, epoch size means the number of samples
between outputting summary information and/or checkpointing. This must be
specified unless the user directly passes numpy/scipy arrays for the
minibatch_source.</p></td>
    </tr>
    <tr>
      <th>max_samples</th>
      <td><p>(int) – maximum number of samples used for training;
mutually exclusive with max_epochs</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The input data can be specified as a data reader (MinibatchSource) for large
corpora; or directly as numpy/scipy arrays if the data is so small that it
is feasible to keep it all in RAM.</p>
<p>Data is processed in minibatches. The minibatch size defaults to 32, which
is a choice that commonly works well. However, for maximum efficiency, we
recommend to experiment with minibatch sizes and choose the largest that
converges well and does not exceed the GPU RAM. This is particularly
important for distributed training, where often, the minibatch size can be
increased throughout the training, which reduces data bandwidth and thus
speeds up parallel training.</p>
<p>If input data is given through a data reader (as opposed to directly as a
numpy/scipy array), the user must also specify the epoch size. This is
because data readers are used for large corpora, and the traditional
definition of epoch size as number of samples in the corpus is not very
relevant. Instead, CNTK really means the number of samples between summary
actions, such as printing training progress, adjusting the learning rate,
and/or checkpointing the model.</p>
<p>The function returns an object that contains these members: epoch_summaries
is a list that contains the progression of epoch loss (.loss) and metric
(.metric) values and the corresponding number of labels (.samples) that they
were averaged over. This is the same value that a progress printer would
print as epoch summaries. updates is a similar list with the more
fine-grained minibatch updates. If a TestConfig was specified, then
test_summary is the metric and sample count on the specified test set for
the final model.</p>
<p>A number of callback mechanisms can optionally be specified as a list as
callbacks. CNTK has a fixed set of callback types, and only those types are
allowed in the callbacks list: An object of type ProgressWriter from
cntk.logging is used for progress logging; a CheckpointConfig configures the
checkpointing mechanism, which keeps copies of models at regular intervals
and allows to seamlessly restart from a last checkpoint; a TestConfig allows
to specify a test set that is evaluated at the end of the training; and a
CrossValidationConfig specifies a user callback that can be used to adjust
learning hyper-parameters or to denote to stop training, optionally based on
a separate cross-validation data set.</p>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>
          </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Ali Zaidi, Joe Davison, Microsoft.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
